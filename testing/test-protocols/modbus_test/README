###############################################################################
# Running Modbus Test Scripts
###############################################################################


#Installing the environment

sudo apt-get install python-pip python-dev
sudo pip install virtualenv

#Directory where modbus scripts are located
cd modbus_directory

#Create a virtual environment
virtualenv venv

#Activate the Virtual Environment
source venv/bin/activate

#Install python modbus into virtual environment

pip version of pymodbus is old (1.2.0) which doesn't have socket
binding for client. We need >= (1.3.0)

Instead do:

git clone pymodbus https://github.com/bashwork/pymodbus
python setup.py install


pip install -U netifaces
pip install -U ipaddress
pip install -U netaddr
pip install -U PyCrypto

#We use ./venv/bin/python since we started using virtual environments 

#For Client
sudo ./venv/bin/python python modbusclient.py

#For Server
sudo ./venv/bin/python python modbusserver.py

#Traffic Generator example
sudo ./venv/bin/python modbusgen.py 2 2 eth0 192.168.5.0/29


#To kill virtual environment
deactivate



#If you need to run the server/client on Priviliged ports, i.e. Ports under 1024
#Without running in a virtual environment
cd modbus_directory
sudo ./venv/bin/python ./modbusclient.py #For Client
sudo ./venv/bin/python ./modbusserver.py #For Server 



